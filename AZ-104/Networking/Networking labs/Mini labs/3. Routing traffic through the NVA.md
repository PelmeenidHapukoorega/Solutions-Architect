# Mini lab 3: Routing traffic through the NVA

Now that i had the NVA and necessary VMs i needed to route the traffic through the NVA

1. Created new file `cloud-init.txt` and then added configuration to it so `inetutils-traceroute` package would be installed when creating new VM.
```bash
code cloud-init.txt
```

Then added following configuration before saving it:
```
#cloud-config
package_upgrade: true
packages:
   - inetutils-traceroute
```

2. Next i created public VM and added the custom data
```bash
az vm create \
--resource-group customroutestest \
--name public \
--vnet-name vnet \
--subnet publicsubnet \
--image Ubuntu2204 \
--admin-username azureuser \
--no-wait \
--custom-data cloud-init.txt \
--admin-password Kadgu7hbdzkyn1ax \
--size Standard_B1ms
```

3. Then i created private VM
```bash
az vm create \
--resource-group "myResourceGroupName" \
--name private \
--vnet-name vnet \
--subnet privatesubnet \
--image Ubuntu2204 \
--admin-username azureuser \
--no-wait \
--custom-data cloud-init.txt \
--admin-password (my password) \
--size Standard_B1ms
``` 

4.  Ran the linux `watch` command to check if VMs were now running:
```bash
watch -d -n 5 "az vm list \
    --resource-group customroutestest \
    --show-details \
    --query '[*].{Name:name, ProvisioningState:provisioningState, PowerState:powerState}' \
    --output table"
```

Output:

<img width="749" height="153" alt="image" src="https://github.com/user-attachments/assets/0438d115-b021-463d-9c8c-c67d2bf008cd" />
